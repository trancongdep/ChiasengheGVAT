<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hội thảo HSE 2026 | Đăng ký & Nhận thư mời</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .hero-bg {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?auto=format&fit=crop&q=80&w=2000');
            background-size: cover; background-position: center;
        }
        #invitationCard { width: 350px; height: 500px; position: absolute; left: -9999px; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md shadow-sm">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <img src="logo_Hse_TS.png" alt="Logo HSE-TS" class="h-12 w-auto">
                <div class="hidden sm:block border-l pl-3">
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-widest">Cộng đồng</p>
                    <p class="text-sm font-bold text-blue-600">Training & Sharing</p>
                </div>
            </div>
            <a href="#register" class="bg-blue-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-blue-700 transition text-sm">ĐĂNG KÝ NGAY</a>
        </div>
    </nav>

    <section class="hero-bg h-[80vh] flex items-center justify-center text-center text-white pt-20">
        <div class="container mx-auto px-6">
            <span class="bg-blue-600/30 text-blue-300 px-4 py-1 rounded-full text-sm font-bold border border-blue-500/30 mb-6 inline-block">HỘI THẢO OFFLINE 08/02/2026</span>
            <h1 class="text-3xl md:text-5xl font-bold mb-6">Cập Nhật Điểm Mới <br>Huấn Luyện ATVSLĐ 2026</h1>
            <p class="text-gray-300 max-w-xl mx-auto mb-8">Đồng hành cùng chuyên gia VDC nắm bắt Luật Hóa chất, Luật Điện lực và ứng dụng AI trong nghề HSE.</p>
        </div>
    </section>

    <section id="register" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl font-bold mb-6">Đăng ký tham dự</h2>
                    <p class="text-gray-600 mb-8">Sau khi đăng ký thành công, hệ thống sẽ tự động tạo **Thư mời điện tử** dành riêng cho bạn. Hãy lưu lại để check-in tại hội trường.</p>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-3 text-sm">
                            <i class="fas fa-map-marker-alt mt-1 text-blue-600"></i>
                            <span>Khu vực Thủ Đức, TP.HCM (Địa điểm chi tiết trong thư mời)</span>
                        </div>
                        <div class="flex items-start space-x-3 text-sm">
                            <i class="fas fa-clock mt-1 text-blue-600"></i>
                            <span>08:30 - 11:30 | Chủ Nhật, 08/02/2026</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 p-8 rounded-3xl border shadow-sm">
                    <form id="regForm" class="space-y-4">
                        <input type="text" id="name" placeholder="Họ và tên" required class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-blue-500 outline-none">
                        <input type="tel" id="phone" placeholder="Số điện thoại" required class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-blue-500 outline-none">
                        <select id="role" class="w-full px-4 py-3 rounded-xl border focus:ring-2 focus:ring-blue-500 outline-none">
                            <option value="Người đi làm">Người đi làm</option>
                            <option value="Sinh viên">Sinh viên (Miễn phí)</option>
                        </select>
                        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl hover:bg-blue-700 transition">NHẬN THƯ MỜI</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <div id="invitationModal" class="fixed inset-0 bg-black/80 z-[60] hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-black"><i class="fas fa-times"></i></button>
            <h3 class="text-xl font-bold mb-4 text-green-600">Đăng ký thành công!</h3>
            <div id="previewArea" class="mb-6 flex justify-center shadow-lg"></div>
            <p class="text-xs text-gray-500 mb-4 italic">Vui lòng chụp màn hình hoặc tải ảnh này để Check-in.</p>
            <button id="downloadBtn" class="bg-green-600 text-white px-6 py-2 rounded-lg font-bold w-full">TẢI THƯ MỜI (.PNG)</button>
        </div>
    </div>

    <div id="invitationCard" class="bg-blue-900 text-white p-8 text-left flex flex-col justify-between">
        <div>
            <div class="flex justify-between items-start mb-10">
                <img src="logo_Hse_TS.png" class="h-10">
                <p class="text-[10px] text-right font-bold opacity-70 uppercase">Official Invitation<br>HSE Workshop 2026</p>
            </div>
            <h2 class="text-2xl font-bold leading-tight mb-2">GIẤY MỜI THAM DỰ</h2>
            <div class="h-1 w-12 bg-orange-400 mb-8"></div>
            
            <p class="text-xs opacity-60 mb-1">Trân trọng kính mời:</p>
            <p id="cardName" class="text-xl font-bold text-orange-400 uppercase mb-6"></p>
            
            <div class="space-y-3 text-sm">
                <p><i class="far fa-calendar-check mr-2"></i> 08/02/2026 | 08:30</p>
                <p><i class="fas fa-map-pin mr-2"></i> Thủ Đức, TP. Hồ Chí Minh</p>
            </div>
        </div>
        
        <div class="border-t border-white/20 pt-4 flex justify-between items-end">
            <div>
                <p class="text-[10px] opacity-60">Đơn vị đồng hành</p>
                <p class="font-black text-lg">VDC</p>
            </div>
            <div class="bg-white p-1 rounded text-blue-900 font-bold text-[8px]">HSE-TS-2026</div>
        </div>
    </div>

    <footer class="py-12 bg-gray-100 border-t">
        <div class="container mx-auto px-6 text-center">
            <p class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4">Đồng hành & Tài trợ</p>
            <div class="flex justify-center items-center">
                <span class="text-3xl font-black text-blue-800">VDC</span>
            </div>
            <p class="mt-8 text-gray-400 text-[10px]">© 2026 HSE Training and Sharing Group. Version 1.1</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCzWjfcD5Dgq7V-i2izb9tKLR6QM6qWPQo",
            authDomain: "tavietnam-78ae8.firebaseapp.com",
            projectId: "tavietnam-78ae8",
            storageBucket: "tavietnam-78ae8.firebasestorage.app",
            messagingSenderId: "670121705534",
            appId: "1:670121705534:web:1027ad98550573ad37116f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.getElementById('regForm').onsubmit = async (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const role = document.getElementById('role').value;

            try {
                // 1. Lưu Firebase
                await addDoc(collection(db, "hse_workshop_2026"), { name, phone, role, date: new Date().toISOString() });
                
                // 2. Cập nhật tên vào thẻ mời ẩn
                document.getElementById('cardName').innerText = name;
                
                // 3. Render ảnh thẻ mời từ HTML
                const card = document.getElementById('invitationCard');
                const canvas = await html2canvas(card);
                const imgData = canvas.toDataURL('image/png');
                
                // 4. Hiển thị Modal
                const preview = document.getElementById('previewArea');
                preview.innerHTML = `<img src="${imgData}" class="max-h-80 rounded-lg">`;
                document.getElementById('invitationModal').classList.remove('hidden');
                
                // Nút tải ảnh
                document.getElementById('downloadBtn').onclick = () => {
                    const link = document.createElement('a');
                    link.download = `Thu-moi-HSE-${name}.png`;
                    link.href = imgData;
                    link.click();
                };
            } catch (err) { alert("Lỗi đăng ký!"); }
        };

        window.closeModal = () => {
            document.getElementById('invitationModal').classList.add('hidden');
        };
    </script>
</body>
</html>
